<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Permainan Kad Pendidikan Islam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f0f7ff;
            color: #333;
        }
.flip-card {
    background-color: transparent;
    width: 100%;
    height: 250px;
    perspective: 1000px;
    cursor: pointer;
}

.flip-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 0.6s ease;
    transform-style: preserve-3d;
}

.flip-card.flipped .flip-card-inner {
    transform: rotateY(180deg);
}

.flip-card-front, .flip-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 1rem;
    overflow: hidden;
}

.flip-card-front {
    background-color: #ffffff;
    color: black;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.flip-card-back {
    background-color: #4CAF50;
    color: white;
    transform: rotateY(180deg);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

        }
        .card {
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .menu-button {
            transition: all 0.3s ease;
        }
        .menu-button:hover {
            transform: scale(1.05);
        }
        .completed::after {
            content: "✓";
            position: absolute;
            top: 10px;
            right: 10px;
            color: #10B981;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            border-radius: 50%;
            animation: fall 5s ease-in infinite;
            z-index: 1000;
        }
        @keyframes fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        .timer-warning {
            animation: blink 0.5s infinite;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .ad-container {
            animation: slideUp 0.5s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="app" class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Main Menu -->
        <div id="main-menu" class="flex flex-col items-center">
            <h1 class="text-4xl font-bold text-center mb-8 text-indigo-800">Permainan Kad Pendidikan Islam</h1>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full max-w-3xl">
                <button id="btn-belajar" class="menu-button bg-gradient-to-r from-blue-500 to-blue-700 text-white text-xl font-bold py-6 px-8 rounded-xl shadow-lg">
                    <div class="flex flex-col items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                        </svg>
                        BELAJAR
                    </div>
                </button>
                
                <button id="btn-kuiz" class="menu-button bg-gradient-to-r from-green-500 to-green-700 text-white text-xl font-bold py-6 px-8 rounded-xl shadow-lg">
                    <div class="flex flex-col items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        KUIZ
                    </div>
                </button>
                
                <div class="relative">
                    <button id="btn-panduan-markah" class="menu-button w-full bg-gradient-to-r from-purple-500 to-purple-700 text-white text-xl font-bold py-6 px-8 rounded-xl shadow-lg">
                        <div class="flex flex-col items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                            </svg>
                            PANDUAN MARKAH
                        </div>
                    </button>
                    <div id="markah-preview" class="hidden absolute z-10 bg-white p-4 rounded-lg shadow-xl w-full">
                        <h3 class="font-bold text-lg mb-2">Pembahagian Markah:</h3>
                        <p>Klik untuk maklumat penuh</p>
                    </div>
                </div>
                
                <button id="btn-buku-panduan" class="menu-button bg-gradient-to-r from-yellow-500 to-yellow-700 text-white text-xl font-bold py-6 px-8 rounded-xl shadow-lg">
                    <div class="flex flex-col items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                        </svg>
                        BUKU PANDUAN
                    </div>
                </button>
            </div>
        </div>

        <!-- Belajar Section -->
        <div id="belajar-section" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold text-indigo-800">Belajar</h2>
                <button id="belajar-home" class="bg-indigo-600 text-white px-4 py-2 rounded-lg flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    MENU UTAMA
                </button>
            </div>
            
            <div id="belajar-kategori" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Kategori cards will be generated here -->
            </div>
            
            <div id="belajar-subkategori" class="hidden">
                <div class="flex items-center mb-6">
                    <button id="belajar-back-to-kategori" class="bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Kembali
                    </button>
                    <h3 id="belajar-subkategori-title" class="text-2xl font-bold text-indigo-700"></h3>
                </div>
                <div id="belajar-subkategori-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Subkategori cards will be generated here -->
                </div>
            </div>
            
            <div id="belajar-soalan" class="hidden">
                <div class="flex items-center mb-6">
                    <button id="belajar-back-to-subkategori" class="bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Kembali
                    </button>
                    <h3 id="belajar-soalan-title" class="text-2xl font-bold text-indigo-700"></h3>
                </div>
                <div id="belajar-soalan-list" class="space-y-6">
                    <!-- Soalan cards will be generated here -->
                </div>
            </div>
        </div>

        <!-- Kuiz Section -->
        <div id="kuiz-section" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold text-green-800">Kuiz</h2>
                <div class="flex items-center">
                    <div id="kuiz-timer" class="bg-gray-200 px-4 py-2 rounded-lg mr-4 font-bold">
                        Masa: 30:00
                    </div>
                    <button id="kuiz-home" class="bg-green-600 text-white px-4 py-2 rounded-lg flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                        </svg>
                        MENU UTAMA
                    </button>
                </div>
            </div>
            
            <div id="kuiz-kategori" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Kategori cards will be generated here -->
            </div>
            
            <div id="kuiz-subkategori" class="hidden">
                <div class="flex items-center mb-6">
                    <button id="kuiz-back-to-kategori" class="bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Kembali
                    </button>
                    <h3 id="kuiz-subkategori-title" class="text-2xl font-bold text-green-700"></h3>
                </div>
                <div id="kuiz-subkategori-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Subkategori cards will be generated here -->
                </div>
            </div>
            
            <div id="kuiz-soalan" class="hidden">
                <div class="flex items-center mb-6">
                    <button id="kuiz-back-to-subkategori" class="bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Kembali
                    </button>
                    <h3 id="kuiz-soalan-title" class="text-2xl font-bold text-green-700"></h3>
                </div>
                <div id="kuiz-soalan-list" class="space-y-6">
                    <!-- Soalan cards will be generated here -->
                </div>
            </div>
        </div>

        <!-- Panduan Markah Section -->
        <div id="panduan-markah-section" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold text-purple-800">Panduan Markah</h2>
                <button id="panduan-home" class="bg-purple-600 text-white px-4 py-2 rounded-lg flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    MENU UTAMA
                </button>
            </div>
            
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-2xl font-bold text-center mb-6">Pembahagian Markah</h3>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-300">
                        <thead>
                            <tr>
                                <th class="py-3 px-4 bg-purple-100 font-semibold text-left border-b">Bahagian</th>
                                <th class="py-3 px-4 bg-purple-100 font-semibold text-left border-b">Kategori</th>
                                <th class="py-3 px-4 bg-purple-100 font-semibold text-center border-b">Markah per Soalan</th>
                                <th class="py-3 px-4 bg-purple-100 font-semibold text-center border-b">Jumlah Soalan</th>
                                <th class="py-3 px-4 bg-purple-100 font-semibold text-center border-b">Jumlah Markah</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="py-3 px-4 border-b font-medium">Bahagian A</td>
                                <td class="py-3 px-4 border-b">Peradaban (ڤرادبن)</td>
                                <td class="py-3 px-4 border-b text-center">1</td>
                                <td class="py-3 px-4 border-b text-center">25</td>
                                <td class="py-3 px-4 border-b text-center font-medium">25</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 border-b font-medium">Bahagian B</td>
                                <td class="py-3 px-4 border-b">Ibadah (عبادة)</td>
                                <td class="py-3 px-4 border-b text-center">2</td>
                                <td class="py-3 px-4 border-b text-center">15</td>
                                <td class="py-3 px-4 border-b text-center font-medium">30</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 border-b font-medium">Bahagian C</td>
                                <td class="py-3 px-4 border-b">Akidah (عقيدة)</td>
                                <td class="py-3 px-4 border-b text-center">2</td>
                                <td class="py-3 px-4 border-b text-center">12</td>
                                <td class="py-3 px-4 border-b text-center font-medium">24</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 border-b font-medium">Bahagian D</td>
                                <td class="py-3 px-4 border-b">Sahsiah (شخصية)</td>
                                <td class="py-3 px-4 border-b text-center">2</td>
                                <td class="py-3 px-4 border-b text-center">10</td>
                                <td class="py-3 px-4 border-b text-center font-medium">20</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 font-bold" colspan="4">Jumlah Markah Keseluruhan</td>
                                <td class="py-3 px-4 text-center font-bold">100</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded">
                    <p class="font-medium">Catatan: Mana-mana jawapan yang sesuai dan munasabah dikira betul.</p>
                    <p class="text-sm mt-2">Sumber: Buku Panduan UPKK07/01 PCHI - Penghayatan Cara Hidup Islam, JAKIM</p>
                </div>
            </div>
        </div>

        <!-- Buku Panduan Section -->
        <div id="buku-panduan-section" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold text-yellow-800">Buku Panduan</h2>
                <button id="buku-home" class="bg-yellow-600 text-white px-4 py-2 rounded-lg flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    MENU UTAMA
                </button>
            </div>
            
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="text-center mb-8">
                    <h3 class="text-2xl font-bold mb-4">Buku Panduan UPKK07/01 PCHI</h3>
                    <p class="text-lg">Penghayatan Cara Hidup Islam, JAKIM</p>
                </div>
                
                <div class="flex justify-center">
                    <div class="bg-yellow-100 border-2 border-yellow-300 rounded-lg p-8 max-w-lg text-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 mx-auto text-yellow-600 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                        </svg>
                        <h4 class="text-xl font-bold mb-4">Buku Panduan PDF</h4>
                        <p class="mb-6">Klik butang di bawah untuk muat turun atau lihat buku panduan lengkap.</p>
                        <button class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            Muat Turun PDF
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modals -->
        <div id="congratulations-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full">
                <div class="text-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-green-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h3 class="text-2xl font-bold mb-2">Tahniah!</h3>
                    <p class="text-lg mb-6">Anda telah berjaya menyelesaikan semua kategori.</p>
                    <div id="score-display" class="hidden mb-6">
                        <h4 class="font-bold text-xl mb-2">Markah Anda:</h4>
                        <p id="final-score" class="text-3xl font-bold text-green-600">0/100</p>
                    </div>
                    <div class="flex justify-center space-x-4">
                        <button id="restart-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg transition duration-300">
                            MAIN SEMULA
                        </button>
                        <button id="modal-home-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition duration-300">
                            MENU UTAMA
                        </button>
<button id="restart-belajar-btn" class="hidden bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg transition duration-300">
    BELAJAR SEMULA
</button>

                    </div>
                </div>
            </div>
        </div>

        <!-- Ad Container -->
        <div id="ad-container" class="hidden fixed bottom-0 left-0 right-0 bg-white shadow-lg p-4 ad-container z-40">
            <div class="container mx-auto flex justify-between items-center">
                <div class="flex items-center">
                    <div class="w-16 h-16 bg-gray-200 rounded-lg mr-4 flex items-center justify-center overflow-hidden" id="ad-image">
                        <!-- Ad image will be placed here -->
                    </div>
                    <div>
                        <h4 id="ad-title" class="font-bold"></h4>
                        <p id="ad-text" class="text-sm"></p>
                    </div>
                </div>
                <div class="flex items-center">
                    <div id="ad-countdown" class="mr-4 font-bold">10</div>
                    <button id="ad-button" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                        HUBUNGI
                    </button>
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-12 py-4 border-t border-gray-200 text-center">
        <p class="text-gray-600">© 2025 Abdul Raqiib bin Basiran & Iqraq Education</p>
        <a href="https://wasap.my/+601172706678" class="text-blue-600 hover:underline">Hubungi saya</a>
    </footer>

    <script>
        // Data Structure
        const data = {
            categories: [
                {
                    id: 'peradaban',
                    name: 'Peradaban',
                    arabicName: 'ڤرادبن',
                    color: 'blue',
                    subCategories: [
                        {
                            id: 'adab-keluarga',
                            name: 'Adab dalam Keluarga',
                            questions: [
                               {question: 'Sebutkan doa untuk ibu kedua-dua ibu bapa?', answer: "رَبِّ اغْفِرْ لِي وَلِوَالِدَيَّ وَارْحَمْهُمَا كَمَا رَبَّيَانِي صَغِيرًا. },
                                { question: 'Bagaimana cara bercakap dengan ibu?', answer: 'Bermanis muka, menggunakan bahasa yang sopan, segera menyahut panggilan, tidak menyampuk percakapan, tidak meninggikan suara.' },
                                { question: 'Bagaimana cara mentaati ibu bapa?', answer: 'Mematuhi setiap arahan yang tidak bertentangan dengan Islam.' },
                                { question: 'Apakah hikmah beradab dengan ibu bapa?', answer: 'Mendapat keberkatan daripada Allah, mendapat pahala, mendapat ketenangan jiwa, disayangi oleh keluarga dan masyarakat.' },
                                { question: 'Apakah akibat derhaka kepada ibu bapa?', answer: 'Hidup tidak diberkati Allah, disisih oleh keluarga dan masyarakat, mendapat dosa, meruntukan keharmonian kekeluargaan.' }
                            ]
                        },
                        {
                            id: 'adab-harian',
                            name: 'Adab dalam Kehidupan Harian',
                            questions: [
                                { question: 'Apakah yang dimaksudkan dengan tetamu?', answer: 'Tetamu ialah orang yang datang berkunjung ke rumah kita sama ada dijemput atau tidak.' },
                                { question: 'Sebutkan faedah melayan tetamu.', answer: 'Akan dimurahkan rezeki, dilimpahkan keberkatan dalam hidup, dapat mengeratkan silaturahim.' },
                                { question: 'Nyatakan adab menziarahi orang sakit', answer: 'Pilih masa yang sesuai, memberi kata-kata perangsang, mendoakannya agar cepat sembuh, memperlihatkan kasih sayang.' },
                                { question: 'Apakah ciri-ciri mulia seorang peniaga?', answer: 'Berpakaian kemas dan menutup aurat, menjaga hati pelanggan, jujur dalam timbangan, berterus terang tentang barangan yang dijual.' },
                                { question: 'Senaraikan adab-adab ketika berada di dalam masjid.', answer: 'Niat iktikaf, solat sunat tahiyyatul masjid, membaca al-Quran, tidak bermain dan membuat bising.' },
                                { question: 'Bagaimana adab ketika menggunakan telefon?', answer: 'Berbicara dengan suara yang sesuai, tidak mengganggu orang lain, dan menggunakan bahasa yang sopan.' }
                            ]
                        },
                        {
                            id: 'adab-sekolah',
                            name: 'Adab di Sekolah',
                            questions: [
                                { question: 'Sebutkan adab-adab bercakap dengan guru.', answer: 'Memberi salam, berjabat tangan, merendahkan suara.' },
                                { question: 'Apakah tujuan kamu pergi ke sekolah?', answer: 'Menuntut ilmu, mendapat rakan, mendapat pahala, mendapat kejayaan di masa depan.' },
                                { question: 'Apakah perkara-perkara yang tidak patut dilakukan ketika guru sedang mengajar?', answer: 'Tidur, bermain, bersembang, membuat bising, tidak menghormati guru.' },
                                { question: 'Sebutkan perlakuan yang tidak wajar dilakukan terhadap rakan', answer: 'Bergaduh, mengumpat, menghina rakan, meninggikan suara.' },
                                { question: 'Bagaimanakah cara menjaga harta benda sekolah.', answer: 'Mematuhi peraturan yang disediakan, tidak menconteng dan merosakkan harta benda sekolah, menyanyangi harta benda tersebut seperti harta sendiri.' }
                            ]
                        },
                        {
                            id: 'adab-pakaian',
                            name: 'Adab Berpakaian',
                            questions: [
                                { question: 'Sebutkan ciri-ciri berpakaian orang Islam.', answer: 'Menutup aurat, sederhana, bersih.' },
                                { question: 'Apakah kesan tidak menutup aurat?', answer: 'Tidak disukai oleh Allah, tidak dihormati, hidup tidak teratur, mengundang bahaya dan maksiat, menggambarkan peribadi buruk.' },
                                { question: 'Apakah tujuan menutup aurat?', answer: 'Menjaga maruah diri, terpelihara daripada fitnah.' },
                                { question: 'Apakah hukum menutup aurat?', answer: 'Wajib.' },
                                { question: 'Sebutkan batas aurat bagi lelaki dan perempuan?', answer: 'Batas aurat lelaki ialah antara pusat hingga lutut manakala bagi perempuan seluruh anggota badan kecuali tapak tangan dan muka.' }
                            ]
                        },
                        {
                            id: 'doa-harian',
                            name: 'Doa Harian',
                            questions: [
                                { question: 'Sila baca doa sebelum belajar.', answer: 'اللّهُمَّ افْتَحْ لَنَا حِكْمَتَكَ، وَانْشُرْ عَلَيْنَا مِنْ خَزَائِنِ رَحْمَتِكَ، يَا أَرْحَمَ الرَّاحِمِينَ.' },
                                { question: 'Apakah doa sebelum tidur.', answer: 'بِاسْمِكَ اللّٰهُمَّ أَمُوتُ وَأَحْيَا' },
                                { question: 'Sila baca doa naik kenderaan.', answer: 'سُبْحَانَ الَّذِي سَخَّرَ لَنَا هَذَا وَمَا كُنَّا لَهُ مُقْرِنِينَ، وَإِنَّا إِلَى رَبِّنَا لَمُنْقَلِبُونَ.' },
                                { question: 'Sila baca doa sebelum makan.', answer: 'الْحَمْدُ لِلّٰهِ الَّذِي أَطْعَمَنَا وَسَقَانَا وَجَعَلَنَا مِنَ الْمُسْلِمِينَ ' },
                                { question: 'Sila baca doa sebelum makan.', answer: 'اللَّهُمَّ بَارِكْ لَنَا فِيمَا رَزَقْتَنَا وَقِنَا عَذَابَ النَّارِ. ' }
                            ]
                      },
                      {
                    id: 'ibadah',
                    name: 'Ibadah',
                    arabicName: 'عبادة',
                    color: 'green',
                    subCategories: [
                        {
                            id: 'toharoh',
                            name: 'Toharoh (Kesucian)',
                            questions: [
                                { question: 'Apakah erti toharoh?', answer: 'Toharoh ialah membersihkan tubuh badan daripada benda-benda najis atau daripada hadas kecil dan hadas besar.' },
                                { question: 'Sebutkan jenis-jenis air mutlak.', answer: 'Air hujan, air sungai, air laut, air embun, air mata air, air salji, air telaga.' },
                                { question: 'Sebutkan jenis-jenis najis.', answer: 'Najis mukhoffafah, najis mutawassitoh, najis mughollazhoh.' }
                            ]
                        },
                        {
                            id: 'solat',
                            name: 'Solat',
                            questions: [
                                { question: 'Berapakah rukun solat?', answer: 'Rukun solat ada tiga belas perkara.' },
                                { question: 'Sebutkan hikmah menunaikan solat.', answer: 'Dapat mendisiplinkan diri, dapat menyihatkan tubuh badan, dapat mencerdaskan akal, dapat menghidari perkara mungkar.' },
                                { question: 'Nyatakan akibat meninggalkan solat.', answer: 'Jiwa tidak tenteram, cenderung melakukan maksiat, disempitkan rezeki.' }
                            ]
                        },
                        {
                            id: 'puasa',
                            name: 'Puasa',
                            questions: [
                                { question: 'Apakah erti puasa?', answer: 'Puasa ialah menahan diri daripada melakukan perkara yang membatalkan puasa dari terbit fajar hingga terbenam matahari disertai niat dan mengikut syarat tertentu.' },
                                { question: 'Sebutkan ciri-ciri ibadah puasa yang sempurna.', answer: 'Melaksanakan semua rukun puasa, mengamalkan perkara sunat puasa, menjauhi perkara makruh ketika berpuasa, meninggalkan perkara haram ketika berpuasa.' },
                                { question: 'Nyatakan hikmah berpuasa.', answer: 'Mengukuhkan iman dan takwa kepada Allah, membentuk sifat mulia seperti sabar dan bersyukur, dapat menjauhkan diri daripada dosa dan kejahatan, menyihatkan tubuh badan dan mencerdaskan akal.' }
                            ]
                        },
                        {
                            id: 'hadas-besar',
                            name: 'Menyucikan Hadas Besar',
                            questions: [
                                { question: 'Nyatakan sebab-sebab yang mewajibkan mandi.', answer: 'Keluar mani, haid, jimak, wiladah, nifas, mati selain mati syahid.' },
                                { question: 'Apakah tujuan mengangkat hadas besar?', answer: 'Membersihkan diri daripada kekotoran jasmani dan rohani serta mengembalikan kecergasan tubuh badan.' },
                                { question: 'Apakah yang haram dilakukan ketika berhadas besar?', answer: 'Bersolat, tawaf, menyentuh, membawa dan membaca al-Quran, masuk ke masjid.' }
                            ]
                        },
                        {
                            id: 'solat-jamak-qasar',
                            name: 'Solat Jamak dan Qasar',
                            questions: [
                                { question: 'Mengapakah solat jamak dan qasar disyariatkan dalam Islam?', answer: 'Memberikan kemudahan kepada orang yang bermusafir.' },
                                { question: 'Apakah hukum solat jamak dan qasar?', answer: 'Hukumnya adalah harus.' },
                                { question: 'Nyatakan satu sebab diharuskan solat jamak dan qasar.', answer: 'Seseorang itu dalam bermusafir, perjalanan itu tidak kurang daripada dua marhalah, perjalanan bertujuan baik.' }
                            ]
                },
                {
                    id: 'akidah',
                    name: 'Akidah',
                    arabicName: 'عقيدة',
                    color: 'purple',
                    subCategories: [
                        {
                            id: 'rukun-islam-iman',
                            name: 'Rukun Islam/Rukun Iman',
                            questions: [
                                { question: 'Sebutkan semua Rukun Islam.', answer: 'Rukun Islam terdiri daripada lima perkara: mengucap dua kalimah syahadah, mendirikan solat lima waktu, menunaikan zakat, berpuasa di bulan Ramadhan, dan menunaikan haji bagi yang mampu.' },
                                { question: 'Sebutkan Rukun Iman.', answer: 'Rukun Iman terdiri daripada enam perkara: beriman kepada Allah, beriman kepada Malaikat, beriman kepada Kitab-kitab, beriman kepada Rasul-rasul, beriman kepada Hari Kiamat, dan beriman kepada Qada\' dan Qadar.' },
                                { question: "Sebutkan lafaz dua kalimah syahadah dan ertinya", answer: "أَشْهَدُ أَنْ لَا إِلَٰهَ إِلَّا اللهُ، وَأَشْهَدُ أَنَّ مُحَمَّدًا رَسُولُ اللهِ. Ertinya: Aku bersaksi bahawa tiada Tuhan melainkan Allah, dan aku bersaksi bahawa Nabi Muhammad itu pesuruh Allah.' }
                            ]
                        },
                        {
                            id: 'sifat-wajib-allah',
                            name: 'Sifat Wajib bagi Allah',
                            questions: [
                                { question: 'Apakah hukum beriman dengan sifat-sifat wajib Allah?', answer: 'Hukum beriman dengannya adalah wajib.' },
                                { question: 'Nyatakan kesan mempercayai sifat-sifat wajib Allah.', answer: 'Dapat menambahkan keyakinan dan keimanan seseorang.' },
                                { question: 'Apakah hukum tidak mempercayai sifat-sifat wajib bagi Allah?', answer: 'Berdosa besar dan dimasukkan ke dalam neraka.' }
                            ]
                        },
                        {
                            id: 'asmaul-husna',
                            name: 'Asmaul Husna',
                            questions: [
                                { question: 'Apakah erti Asmaul Husna?', answer: 'Asmaul Husna ialah nama-nama Allah yang baik dan indah.' },
                                { question: 'Berapakah jumlah Asmaul Husna?', answer: 'Jumlahnya 99.' },
                                { question: 'Berikan erti bagi empat nama Allah berikut.', answer: 'Ar-Rahman (Maha Pemurah), Ar-Rahim (Maha Penyayang), Al-Malik (Maha Berkuasa), Al-Quddus (Maha Suci).' },
                            ]
                        },
                        {
                            id: 'sifat-rasul',
                            name: 'Sifat Mustahil dan Wajib bagi Rasul',
                            questions: [
                                { question: 'Sebutkan sifat-sifat wajib bagi Rasul?', answer: 'Sifat wajib bagi Rasul adalah Siddiq (benar), Amanah (jujur), Tabligh (menyampaikan), dan Fatanah (bijaksana).' },
                                { question: 'Berapakah sifat mustahil bagi Rasul?', answer: 'Sifat mustahil bagi Rasul ada empat.' },
                                { question: 'Sebutkan tiga contoh sifat harus bagi Rasul', answer: 'Contoh sifat harus bagi Rasul ialah makan, minum, dan tidur (Sifat yang bersesuaian boleh diterima).' }
                            ]
                },
                {
                    id: 'sahsiah',
                    name: 'Sahsiah',
                    arabicName: 'شخصية',
                    color: 'red',
                    subCategories: [
                        {
                            id: 'ihsan',
                            name: 'Ihsan',
                            questions: [
                                { question: 'Apakah maksud ihsan?', answer: 'Ihsan bermaksud melakukan ibadah dengan baik dan bersungguh-sungguh kerana sedar Allah melihat, mendengar dan mengetahuinya.' },
                                { question: 'Apakah sifat utama dalam ihsan.', answer: 'Sentiasa mengharap keredaan Allah.' }
                            ]
                        },
                        {
                            id: 'amanah',
                            name: 'Amanah',
                            questions: [
                                { question: 'Apakah akibat tidak amanah?', answer: 'Mendapat dosa, tidak dipercayai rakan, dimusuhi oleh rakan.' },
                                { question: 'Sebutkan ciri-ciri pelajar yang amanah.', answer: 'Melaksanakan setiap tugasan yang diberikan, menjaga kebersihan kelas, menepati masa belajar, tidak mengambil harta benda orang lain.' }
                            ]
                        },
                        {
                            id: 'takwa',
                            name: 'Takwa',
                            questions: [
                                { question: 'Apakah maksud takwa?', answer: 'Takwa bermaksud mengerjakan perintah Allah dan menjauhi larangan-Nya.' },
                                { question: 'Mengapakah kita perlu bertakwa?', answer: 'Mendapat keredaan Allah, mendapat pahala, memperoleh kebahagian di dunia dan di akhirat.' }
                            ]
                        },
                        {
                            id: 'istiqamah',
                            name: 'Istiqamah',
                            questions: [
                                { question: 'Berikan contoh istiqamah seorang pelajar.', answer: 'Sentiasa menepati masa, berterusan mengulang kaji pelajaran.' },
                                { question: 'Mengapakah seorang pelajar perlu bersifat istiqamah?', answer: 'Dia perlu beristiqamah supaya mencapai kejayaan dan tidak mudah berputus asa.' }
                            ]
                        },
                        {
                            id: 'tawaduk',
                            name: 'Tawaduk',
                            questions: [
                                { question: 'Sebutkan ciri tawaduk pada seorang pelajar yang berjaya.', answer: 'Bersyukur kepada Allah, tidak berbangga diri, suka berkongsi ilmu dengan orang lain.' },
                                { question: 'Apakah kelebihan orang yang bertawaduk?', answer: 'Taat perintah Allah, bersifat lemah lembut dan penyabar, bijaksana.' }
                            ]
                        }
                    ]
                }
            ]
        };

        // Game state
        const gameState = {
            belajar: {
                completedCategories: {},
                completedSubCategories: {},
                currentCategory: null,
                currentSubCategory: null
            },
            kuiz: {
                completedCategories: {},
                completedSubCategories: {},
                score: 0,
                timer: null,
                timeLeft: 30 * 60, // 30 minutes in seconds
                isRunning: false,
                currentCategory: null,
                currentSubCategory: null
            },
            currentAd: null,
            adTimer: null,
            adCountdown: null
        };

        // Helper functions
        function createSVG(type, color) {
            let svgContent = '';
            
            switch(type) {
                case "book":
                    svgContent = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" width="100%" height="100%"><path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>`;
                    break;
                case "quran":
                    svgContent = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" width="100%" height="100%"><path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>`;
                    break;
                case "mobile":
                    svgContent = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" width="100%" height="100%"><path d="M12 18.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"></path><path d="M17 2H7a2 2 0 00-2 2v16a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2zm-1 18H8V4h8v16z"></path></svg>`;
                    break;
                case "seminar":
                    svgContent = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" width="100%" height="100%"><path d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v12a2 2 0 01-2 2zM12 6a1 1 0 100 2 1 1 0 000-2zM6 12a1 1 0 100 2 1 1 0 000-2zm0-4a1 1 0 100 2 1 1 0 000-2zm12 0a1 1 0 100 2 1 1 0 000-2zm0 4a1 1 0 100 2 1 1 0 000-2zm-6 4a1 1 0 100 2 1 1 0 000-2z"></path></svg>`;
                    break;
                case "tools":
                    svgContent = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" width="100%" height="100%"><path d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"></path></svg>`;
                    break;
                default:
                    svgContent = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" width="100%" height="100%"><circle cx="12" cy="12" r="10"></circle></svg>`;
            }
            
            return svgContent;
        }

        function showSection(sectionId) {
            document.querySelectorAll('#app > div').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function startQuizTimer() {
            if (gameState.kuiz.timer) {
                clearInterval(gameState.kuiz.timer);
            }
            
            gameState.kuiz.timeLeft = 30 * 60; // Reset to 30 minutes
            gameState.kuiz.isRunning = true;
            
            updateTimerDisplay();
            
            gameState.kuiz.timer = setInterval(() => {
                if (gameState.kuiz.timeLeft > 0) {
                    gameState.kuiz.timeLeft--;
                    updateTimerDisplay();
                    
                    // Warning when 1 minute left
                    if (gameState.kuiz.timeLeft === 60) {
                        document.getElementById('kuiz-timer').classList.add('timer-warning');
                    }
                } else {
                    endQuiz();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            document.getElementById('kuiz-timer').textContent = `Masa: ${formatTime(gameState.kuiz.timeLeft)}`;
        }

        function endQuiz() {
            clearInterval(gameState.kuiz.timer);
            gameState.kuiz.isRunning = false;
            
            document.getElementById('final-score').textContent = `${gameState.kuiz.score}/100`;
            document.getElementById('score-display').classList.remove('hidden');
            document.getElementById('congratulations-modal').classList.remove('hidden');
            
            createConfetti();
        }

        function createConfetti() {
            const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800', '#FF5722'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
                confetti.style.animationDelay = `${Math.random() * 2}s`;
                
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        function getCategoryColor(color) {
            const colors = {
                'blue': '#3B82F6',
                'green': '#10B981',
                'purple': '#8B5CF6',
                'red': '#EF4444',
                'yellow': '#F59E0B'
            };
            
            return colors[color] || '#3B82F6';
        }

        // Render functions for Belajar mode
        function renderBelajarKategori() {
            const container = document.getElementById('belajar-kategori');
            container.innerHTML = '';
            
            data.categories.forEach(category => {
                const isCompleted = gameState.belajar.completedCategories[category.id];
                const card = document.createElement('div');
                card.className = `card relative bg-white rounded-xl shadow-lg overflow-hidden ${isCompleted ? 'completed' : ''}`;
                card.style.borderLeft = `6px solid ${getCategoryColor(category.color)}`;
                
                card.innerHTML = `
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">${category.name}</h3>
                        <p class="text-gray-600 mb-4">${category.arabicName}</p>
                        <p class="text-sm text-gray-500">${category.subCategories.length} subkategori</p>
                    </div>
                `;
                
                card.addEventListener('click', () => {
                    gameState.belajar.currentCategory = category;
                    renderBelajarSubkategori(category);
                    showBelajarSubkategori();
                });
                
                container.appendChild(card);
            });
            
            document.getElementById('belajar-subkategori').classList.add('hidden');
            document.getElementById('belajar-soalan').classList.add('hidden');
            document.getElementById('belajar-kategori').classList.remove('hidden');
        }

        function renderBelajarSubkategori(category) {
            const container = document.getElementById('belajar-subkategori-list');
            container.innerHTML = '';
            
            document.getElementById('belajar-subkategori-title').textContent = `${category.name} (${category.arabicName})`;
            
            category.subCategories.forEach(subCategory => {
                const isCompleted = gameState.belajar.completedSubCategories[subCategory.id];
                const card = document.createElement('div');
                card.className = `card relative bg-white rounded-xl shadow-lg overflow-hidden ${isCompleted ? 'completed' : ''}`;
                card.style.borderLeft = `6px solid ${getCategoryColor(category.color)}`;
                
                card.innerHTML = `
                    <div class="p-6">
                        <h4 class="text-lg font-bold mb-2">${subCategory.name}</h4>
                        <p class="text-sm text-gray-500">${subCategory.questions.length} soalan</p>
                    </div>
                `;
                
                card.addEventListener('click', () => {
                    gameState.belajar.currentSubCategory = subCategory;
                    renderBelajarSoalan(category, subCategory);
                    showBelajarSoalan();
                });
                
                container.appendChild(card);
            });
            
            document.getElementById('belajar-kategori').classList.add('hidden');
            document.getElementById('belajar-subkategori').classList.remove('hidden');
            document.getElementById('belajar-soalan').classList.add('hidden');
        }

function renderBelajarSoalan(category, subCategory) {
    const container = document.getElementById('belajar-soalan-list');
    container.innerHTML = '';

    document.getElementById('belajar-soalan-title').textContent = subCategory.name;

    gameState.belajar.currentSubCategory = subCategory;
    gameState.belajar.currentCategory = category;
    gameState.belajar.currentQuestionIndex = 0; // Mula dari soalan pertama

    showBelajarCurrentQuestion();
}

function showBelajarCurrentQuestion() {
    const container = document.getElementById('belajar-soalan-list');
    container.innerHTML = '';

    const subCategory = gameState.belajar.currentSubCategory;
    const questionIndex = gameState.belajar.currentQuestionIndex;
    const totalQuestions = subCategory.questions.length;

    if (questionIndex >= totalQuestions) {
        // Semua soalan dah habis
        gameState.belajar.completedSubCategories[subCategory.id] = true;

        // Semak kalau semua subkategori dalam kategori ini dah selesai
        const allDone = gameState.belajar.currentCategory.subCategories.every(sc => gameState.belajar.completedSubCategories[sc.id]);

        if (allDone) {
            gameState.belajar.completedCategories[gameState.belajar.currentCategory.id] = true;
        }

        // Kembali ke Subkategori List
        renderBelajarSubkategori(gameState.belajar.currentCategory);
        showBelajarSubkategori();

        // Kalau semua kategori habis, keluar popup Tahniah
const semuaKategoriHabis = data.categories.every(cat => gameState.belajar.completedCategories[cat.id]);
if (semuaKategoriHabis) {
    document.getElementById('congratulations-modal').classList.remove('hidden');
    document.getElementById('score-display').classList.add('hidden'); // sembunyikan markah
    document.getElementById('restart-belajar-btn').classList.remove('hidden'); // tunjuk Belajar Semula
    document.getElementById('restart-btn').classList.add('hidden'); // sembunyikan Main Semula
}


        return;
    }

    const question = subCategory.questions[questionIndex];

    const card = document.createElement('div');
    card.className = 'bg-white rounded-xl shadow-lg p-6';

    card.innerHTML = `
        <h5 class="text-lg font-bold mb-4">Soalan ${questionIndex + 1} / ${totalQuestions}</h5>
        <p class="text-xl mb-6">${question.question}</p>
        <div class="text-center">
            <button id="next-question-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-lg font-bold">Soalan Seterusnya</button>
        </div>
    `;

    container.appendChild(card);

    document.getElementById('next-question-btn').addEventListener('click', () => {
        // Bila klik, tunjukkan jawapan dulu
        card.innerHTML = `
            <h5 class="text-lg font-bold mb-4">Soalan ${questionIndex + 1} / ${totalQuestions}</h5>
            <p class="text-xl mb-6">${question.question}</p>
            <p class="text-green-600 font-bold mb-6">${question.answer}</p>
            <div class="text-center">
                <button id="continue-btn" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg text-lg font-bold">Teruskan</button>
            </div>
        `;

        document.getElementById('continue-btn').addEventListener('click', () => {
            gameState.belajar.currentQuestionIndex++;
            showBelajarCurrentQuestion();
        });
    });
}



        // Render functions for Kuiz mode
        function renderKuizKategori() {
            const container = document.getElementById('kuiz-kategori');
            container.innerHTML = '';
            
            data.categories.forEach(category => {
                const isCompleted = gameState.kuiz.completedCategories[category.id];
                const card = document.createElement('div');
                card.className = `card relative bg-white rounded-xl shadow-lg overflow-hidden ${isCompleted ? 'completed' : ''}`;
                card.style.borderLeft = `6px solid ${getCategoryColor(category.color)}`;
                
                card.innerHTML = `
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">${category.name}</h3>
                        <p class="text-gray-600 mb-4">${category.arabicName}</p>
                        <p class="text-sm text-gray-500">${category.subCategories.length} subkategori</p>
                    </div>
                `;
                
                card.addEventListener('click', () => {
                    gameState.kuiz.currentCategory = category;
                    renderKuizSubkategori(category);
                    showKuizSubkategori();
                });
                
                container.appendChild(card);
            });
            
            document.getElementById('kuiz-subkategori').classList.add('hidden');
            document.getElementById('kuiz-soalan').classList.add('hidden');
            document.getElementById('kuiz-kategori').classList.remove('hidden');
        }

        function renderKuizSubkategori(category) {
            const container = document.getElementById('kuiz-subkategori-list');
            container.innerHTML = '';
            
            document.getElementById('kuiz-subkategori-title').textContent = `${category.name} (${category.arabicName})`;
            
            category.subCategories.forEach(subCategory => {
                const isCompleted = gameState.kuiz.completedSubCategories[subCategory.id];
                const card = document.createElement('div');
                card.className = `card relative bg-white rounded-xl shadow-lg overflow-hidden ${isCompleted ? 'completed' : ''}`;
                card.style.borderLeft = `6px solid ${getCategoryColor(category.color)}`;
                
                card.innerHTML = `
                    <div class="p-6">
                        <h4 class="text-lg font-bold mb-2">${subCategory.name}</h4>
                        <p class="text-sm text-gray-500">${subCategory.questions.length} soalan</p>
                    </div>
                `;
                
                card.addEventListener('click', () => {
                    gameState.kuiz.currentSubCategory = subCategory;
                    renderKuizSoalan(category, subCategory);
                    showKuizSoalan();
                });
                
                container.appendChild(card);
            });
            
            document.getElementById('kuiz-kategori').classList.add('hidden');
            document.getElementById('kuiz-subkategori').classList.remove('hidden');
            document.getElementById('kuiz-soalan').classList.add('hidden');
        }

function renderKuizSoalan(category, subCategory) {
    const container = document.getElementById('kuiz-soalan-list');
    container.innerHTML = '';

    document.getElementById('kuiz-soalan-title').textContent = subCategory.name;

    gameState.kuiz.currentSubCategory = subCategory;
    gameState.kuiz.currentCategory = category;
    gameState.kuiz.currentQuestionIndex = 0; // mula dari soalan 0

    showKuizCurrentQuestion();
}

function showKuizCurrentQuestion() {
    const container = document.getElementById('kuiz-soalan-list');
    container.innerHTML = '';

    const subCategory = gameState.kuiz.currentSubCategory;
    const questionIndex = gameState.kuiz.currentQuestionIndex;
    const totalQuestions = subCategory.questions.length;

    if (questionIndex >= totalQuestions) {
        // Semua soalan dah habis
        gameState.kuiz.completedSubCategories[subCategory.id] = true;

        // Semak kalau semua subkategori dalam kategori ini dah selesai
        const allDone = gameState.kuiz.currentCategory.subCategories.every(sc => gameState.kuiz.completedSubCategories[sc.id]);

        if (allDone) {
            gameState.kuiz.completedCategories[gameState.kuiz.currentCategory.id] = true;
        }

        // Kembali ke Subkategori List
        renderKuizSubkategori(gameState.kuiz.currentCategory);
        showKuizSubkategori();

        // Kalau semua kategori habis, keluar popup Tahniah
        const semuaKategoriHabis = data.categories.every(cat => gameState.kuiz.completedCategories[cat.id]);
        if (semuaKategoriHabis) {
            clearInterval(gameState.kuiz.timer); // Hentikan masa
            document.getElementById('final-score').textContent = `${gameState.kuiz.score}/100`;
            document.getElementById('score-display').classList.remove('hidden');
            document.getElementById('congratulations-modal').classList.remove('hidden');
        }

        return;
    }

    const question = subCategory.questions[questionIndex];

    const card = document.createElement('div');
    card.className = 'bg-white rounded-xl shadow-lg p-6';

    let pointValue = 1;
    if (gameState.kuiz.currentCategory.id === 'ibadah' || gameState.kuiz.currentCategory.id === 'akidah' || gameState.kuiz.currentCategory.id === 'sahsiah') {
        pointValue = 2;
    }

    card.innerHTML = `
        <h5 class="text-lg font-bold mb-4">Soalan ${questionIndex + 1} / ${totalQuestions}</h5>
        <p class="text-xl mb-6">${question.question}</p>
        <div class="text-center space-x-4">
            <button id="jawab-betul" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg text-lg font-bold">Betul (+${pointValue} markah)</button>
            <button id="jawab-salah" class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg text-lg font-bold">Salah</button>
        </div>
    `;

    container.appendChild(card);

    document.getElementById('jawab-betul').addEventListener('click', () => {
        jawabSoalan(true, pointValue);
    });

    document.getElementById('jawab-salah').addEventListener('click', () => {
        jawabSoalan(false, 0);
    });
}

function jawabSoalan(betul, markah) {
    if (betul) {
        gameState.kuiz.score += markah;
    }

    // Disable dua-dua butang
    document.getElementById('jawab-betul').disabled = true;
    document.getElementById('jawab-salah').disabled = true;
    document.getElementById('jawab-betul').classList.add('opacity-50');
    document.getElementById('jawab-salah').classList.add('opacity-50');

    // Delay sikit baru ke soalan seterusnya
    setTimeout(() => {
        gameState.kuiz.currentQuestionIndex++;
        showKuizCurrentQuestion();
    }, 500);
}

function showBelajarKategori() {
    document.getElementById('belajar-kategori').classList.remove('hidden');
    document.getElementById('belajar-subkategori').classList.add('hidden');
    document.getElementById('belajar-soalan').classList.add('hidden');
}

function showBelajarSubkategori() {
    document.getElementById('belajar-kategori').classList.add('hidden');
    document.getElementById('belajar-subkategori').classList.remove('hidden');
    document.getElementById('belajar-soalan').classList.add('hidden');
}

function showBelajarSoalan() {
    document.getElementById('belajar-kategori').classList.add('hidden');
    document.getElementById('belajar-subkategori').classList.add('hidden');
    document.getElementById('belajar-soalan').classList.remove('hidden');
}

function showKuizKategori() {
    document.getElementById('kuiz-kategori').classList.remove('hidden');
    document.getElementById('kuiz-subkategori').classList.add('hidden');
    document.getElementById('kuiz-soalan').classList.add('hidden');
}

function showKuizSubkategori() {
    document.getElementById('kuiz-kategori').classList.add('hidden');
    document.getElementById('kuiz-subkategori').classList.remove('hidden');
    document.getElementById('kuiz-soalan').classList.add('hidden');
}

function showKuizSoalan() {
    document.getElementById('kuiz-kategori').classList.add('hidden');
    document.getElementById('kuiz-subkategori').classList.add('hidden');
    document.getElementById('kuiz-soalan').classList.remove('hidden');
}


function habisKuiz() {
    setTimeout(() => {
        document.getElementById('final-score').textContent = `${gameState.kuiz.score}/100`;
        document.getElementById('score-display').classList.remove('hidden');
        document.getElementById('congratulations-modal').classList.remove('hidden');
        createConfetti();
    }, 500); // Delay sikit supaya smooth
}


// Bila page siap load, terus tunjuk Main Menu
window.addEventListener('DOMContentLoaded', () => {
    showSection('main-menu');
});

// Event listener butang utama
document.getElementById('btn-belajar').addEventListener('click', () => {
    showSection('belajar-section');
    renderBelajarKategori();
    showBelajarKategori();
});

document.getElementById('btn-kuiz').addEventListener('click', () => {
    showSection('kuiz-section');
    renderKuizKategori();
    showKuizKategori();
    startQuizTimer();
});

document.getElementById('btn-panduan-markah').addEventListener('click', () => {
    showSection('panduan-markah-section');
});

document.getElementById('btn-buku-panduan').addEventListener('click', () => {
    showSection('buku-panduan-section');
});

// Event listener untuk semua butang "Home" kembali ke Main Menu
document.getElementById('belajar-home').addEventListener('click', () => {
    showSection('main-menu');
});
document.getElementById('kuiz-home').addEventListener('click', () => {
    showSection('main-menu');
});
document.getElementById('panduan-home').addEventListener('click', () => {
    showSection('main-menu');
});
document.getElementById('buku-home').addEventListener('click', () => {
    showSection('main-menu');
});

// Event listener bila habis kuiz
document.getElementById('modal-home-btn').addEventListener('click', () => {
    showSection('main-menu');
    document.getElementById('congratulations-modal').classList.add('hidden');
});
document.getElementById('restart-btn').addEventListener('click', () => {
    window.location.reload();
});
document.getElementById('restart-belajar-btn').addEventListener('click', () => {
    window.location.reload();
});


// Event listener BELAJAR - Kembali dari Subkategori ke Kategori
document.getElementById('belajar-back-to-kategori').addEventListener('click', () => {
    renderBelajarKategori();
    showBelajarKategori();
});

document.getElementById('belajar-back-to-subkategori').addEventListener('click', () => {
    renderBelajarSubkategori(gameState.belajar.currentCategory);
    showBelajarSubkategori();
});

document.getElementById('kuiz-back-to-kategori').addEventListener('click', () => {
    renderKuizKategori();
    showKuizKategori();
});

document.getElementById('kuiz-back-to-subkategori').addEventListener('click', () => {
    renderKuizSubkategori(gameState.kuiz.currentCategory);
    showKuizSubkategori();
});
</script>



  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Iklan Floating + Smooth + Bounce</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Hover Glow */
    .hover\:glow:hover {
      box-shadow: 0 0 12px 5px rgba(59, 130, 246, 0.6);
    }

    /* Fade Transition */
    .fade {
      transition: opacity 0.5s ease;
    }

    /* Bounce Animation */
    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    .animate-bounce-custom {
      animation: bounce 0.5s;
    }
  </style>



<!-- Iklan Floating -->
<div id="floatingAd" class="fixed bottom-32 right-6 w-48 bg-white shadow-2xl rounded-full border border-gray-300 p-2 overflow-hidden transition-all duration-700 ease-in-out">

  <!-- Bubble Header -->
  <div id="bubbleHeader" class="flex items-center justify-center bg-blue-600 text-white rounded-full px-4 py-2 shadow-md cursor-pointer hover:glow relative transition-all duration-700 ease-in-out">
    <span id="bubbleText" class="text-xs font-semibold tracking-wide text-center">Tawaran Hebat untuk Anda</span>
  </div>

  <!-- Button Close -->
  <button id="toggleButton" class="hidden absolute top-2 right-2 bg-white text-blue-600 text-xs font-bold rounded-full w-7 h-7 flex items-center justify-center hover:bg-blue-100 transition-all duration-300 ease-in-out z-50">
    ✕
  </button>

  <!-- Kandungan Iklan -->
  <div id="adContent" class="mt-2 opacity-0 hidden fade">
    <img id="adImage" src="" alt="Gambar Iklan" class="w-full max-h-40 object-contain mb-3 rounded-md bg-gray-100">
    
    <h2 id="adHeadline" class="text-xl font-bold text-gray-800 mb-2 text-center">Tawaran Hebat!</h2>
    <p id="adDescription" class="text-sm text-gray-600 mb-3 text-justify leading-relaxed tracking-wide">Hubungi kami hari ini untuk diskaun eksklusif!</p>
    <a id="adLink" href="#" target="_blank" class="block w-full bg-blue-600 text-white text-center py-2 rounded-md hover:bg-blue-700 transition-all duration-700 font-semibold text-sm">Hubungi</a>
  </div>

</div>

<!-- Skrip -->
<script>
  const ads = [
    {
      image: "https://raw.githubusercontent.com/raqiib95/penghayatan-cara-hidup-islam/refs/heads/main/images/servis%20iklan%20bulanan.png",
      headline: "Servis Iklan",
      description: "Hebahkan produk/servis anda serendah RM50/bulan. Klik Hubungi.",
      link: "https://wa.me/60123456789"
    },
    {
      image: "https://raw.githubusercontent.com/raqiib95/penghayatan-cara-hidup-islam/refs/heads/main/images/nota%20%26%20latihan%20upkk.png",
      headline: "Nota Latihan UPKK",
      description: "Dapatkan nota & latihan ekslusif UPKK. Klik Hubungi!",
      link: "https://example.com/kelas-arab"
    },
    {
      image: "https://raw.githubusercontent.com/raqiib95/penghayatan-cara-hidup-islam/refs/heads/main/images/group%20telegram.png",
      headline: "BBM Percuma!",
      description: "Layari BBM Percuma dengan join channel kami. Klik Hubungi.",
      link: "https://t.me/iqraqedu"
    },
    {
      image: "https://raw.githubusercontent.com/raqiib95/penghayatan-cara-hidup-islam/refs/heads/main/images/sokongan.png",
      headline: "Sokong Kami",
      description: "Nak bantu menyokong pembangunan BBM kami? Scan QR atau klik hubungi.",
      link: "https://example.com/langganan"
    },
    {
      image: "https://raw.githubusercontent.com/raqiib95/penghayatan-cara-hidup-islam/refs/heads/main/images/servis%20iklan%20bulanan.png",
      headline: "Iklan RM50 je",
      description: "Jom beriklan dengan kami serendah RM50/bulan.",
      link: "https://example.com/sumbangan"
    }
  ];

  let currentAdIndex = 0;
  let isMinimised = true;

  function updateAd() {
    const ad = ads[currentAdIndex];
    document.getElementById('adImage').src = ad.image;
    document.getElementById('adHeadline').innerText = ad.headline;
    document.getElementById('adDescription').innerText = ad.description;
    document.getElementById('adLink').href = ad.link;

    currentAdIndex = (currentAdIndex + 1) % ads.length;
  }

  updateAd();
  setInterval(updateAd, 10000);

  const floatingAd = document.getElementById('floatingAd');
  const adContent = document.getElementById('adContent');
  const toggleButton = document.getElementById('toggleButton');
  const bubbleText = document.getElementById('bubbleText');
  const bubbleHeader = document.getElementById('bubbleHeader');

  function minimiseAd() {
    adContent.classList.add('opacity-0'); // fade out content
    setTimeout(() => {
      adContent.classList.add('hidden');
      floatingAd.style.width = '12rem';
      floatingAd.classList.add('rounded-full');
      floatingAd.classList.add('animate-bounce-custom'); // trigger bounce
      setTimeout(() => {
        floatingAd.classList.remove('animate-bounce-custom'); // reset
      }, 500);
      bubbleHeader.classList.remove('hidden');
      bubbleText.innerText = 'Tawaran Hebat untuk Anda';
      toggleButton.classList.add('hidden');
    }, 500);
    isMinimised = true;
  }

  function maximiseAd() {
    floatingAd.classList.remove('rounded-full');
    floatingAd.classList.add('rounded-lg');
    floatingAd.style.width = '20rem';
    bubbleHeader.classList.add('hidden');
    toggleButton.classList.remove('hidden');
    adContent.classList.remove('hidden');
    setTimeout(() => {
      adContent.classList.remove('opacity-0');
    }, 50);
    isMinimised = false;
  }

  function toggleAd() {
    if (isMinimised) {
      maximiseAd();
    } else {
      minimiseAd();
    }
  }

  toggleButton.addEventListener('click', (e) => {
    e.stopPropagation();
    toggleAd();
  });

  bubbleHeader.addEventListener('click', () => {
    toggleAd();
  });

  setInterval(() => {
    if (isMinimised) {
      maximiseAd();
    }
  }, 90000);
</script>


</body></html>
